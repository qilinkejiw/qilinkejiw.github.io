<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>c++强制类型转换 | 麒麟科技</title>
  <meta name="description" content="类型转换操作符:static_cast, dynamic_cast, const_cast, reinterpret_cast. 呵呵，今天来好好看看着几个转换操作符的用法。以前老是看着眼熟，但是用着手生。今天决定搞定这些个东西。在C语言中类型转换有几种方式：   (expression). 在表达式外边加括号，由编译器来决定怎么改变。    new_type(expression）. 强制类型括">
<meta property="og:type" content="article">
<meta property="og:title" content="c++强制类型转换">
<meta property="og:url" content="http://example.com/2021/03/15/language_c_cpp_keyword_convert/index.html">
<meta property="og:site_name" content="����Ƽ�">
<meta property="og:description" content="类型转换操作符:static_cast, dynamic_cast, const_cast, reinterpret_cast. 呵呵，今天来好好看看着几个转换操作符的用法。以前老是看着眼熟，但是用着手生。今天决定搞定这些个东西。在C语言中类型转换有几种方式：   (expression). 在表达式外边加括号，由编译器来决定怎么改变。    new_type(expression）. 强制类型括">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-15T14:17:14.269Z">
<meta property="article:modified_time" content="2021-03-24T13:11:42.272Z">
<meta property="article:author" content="Mr.wang">
<meta property="article:tag" content="c++&amp;c语言">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://example.com/2021/03/15/language_c_cpp_keyword_convert/index.html">
  
    <link rel="alternate" href="/atom.xml" title="����Ƽ�" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.0"></head>


<body class="main-center theme-green" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/cofess" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">昵称</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Web Developer &amp; Designer</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> beijing, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-books">
          <a href="/books">
            
            <i class="icon icon-book-fill"></i>
            
            <span class="menu-title">书单</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">友链</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/cofess" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://weibo.com/cofess" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="https://twitter.com/iwebued" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
        <li><a href="https://www.behance.net/cofess" target="_blank" title="Behance" data-toggle=tooltip data-placement=top><i class="icon icon-behance"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/idea/">idea</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/management/">management</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/search/">search</a><span class="category-list-count">7</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/search/clucene/">clucene</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/search/elasticsearch/">elasticsearch</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/search/indextank/">indextank</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/search/kingso/">kingso</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/search/lucene/">lucene</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/search/sphinx/">sphinx</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%A5%E6%BA%90/">来源</a><span class="category-list-count">9</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%A5%E6%BA%90/%E5%8E%9F%E5%88%9B/">原创</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%A5%E6%BA%90/%E8%BD%AC%E8%BD%BD/">转载</a><span class="category-list-count">7</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB/">生活</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB/%E4%B8%8A%E5%AD%A6%E7%9A%84%E6%84%8F%E4%B9%89/">上学的意义</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AF%AD%E8%A8%80/">语言</a><span class="category-list-count">20</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AF%AD%E8%A8%80/c-c%E8%AF%AD%E8%A8%80/">c++&c语言</a><span class="category-list-count">20</span></li></ul></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/c-c%E8%AF%AD%E8%A8%80/" rel="tag">c++&c语言</a><span class="tag-list-count">21</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/clucene/" rel="tag">clucene</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsearch/" rel="tag">elasticsearch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/idea/" rel="tag">idea</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/indextank/" rel="tag">indextank</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kingso/" rel="tag">kingso</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lucene/" rel="tag">lucene</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/management/" rel="tag">management</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sphinx/" rel="tag">sphinx</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/c-c%E8%AF%AD%E8%A8%80/" style="font-size: 14px;">c++&c语言</a> <a href="/tags/clucene/" style="font-size: 13px;">clucene</a> <a href="/tags/elasticsearch/" style="font-size: 13px;">elasticsearch</a> <a href="/tags/idea/" style="font-size: 13px;">idea</a> <a href="/tags/indextank/" style="font-size: 13px;">indextank</a> <a href="/tags/kingso/" style="font-size: 13px;">kingso</a> <a href="/tags/lucene/" style="font-size: 13px;">lucene</a> <a href="/tags/management/" style="font-size: 13px;">management</a> <a href="/tags/sphinx/" style="font-size: 13.5px;">sphinx</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">45</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E8%AF%AD%E8%A8%80/">语言</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/%E8%AF%AD%E8%A8%80/c-c%E8%AF%AD%E8%A8%80/">c++&c语言</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/24/language_c_cpp_keyword_sizeof_3/" class="title">设置字节对齐</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-23T23:15:54.507Z" itemprop="datePublished">2021-03-24</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E8%AF%AD%E8%A8%80/">语言</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/%E8%AF%AD%E8%A8%80/c-c%E8%AF%AD%E8%A8%80/">c++&c语言</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/17/language_c_cpp_keyword_sizeof_2/" class="title">内存对齐</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-17T13:52:29.627Z" itemprop="datePublished">2021-03-17</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E8%AF%AD%E8%A8%80/">语言</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/%E8%AF%AD%E8%A8%80/c-c%E8%AF%AD%E8%A8%80/">c++&c语言</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/17/language_c_cpp_f_1_c/" class="title">函数</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-17T01:17:54.001Z" itemprop="datePublished">2021-03-17</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E6%9D%A5%E6%BA%90/">来源</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/%E6%9D%A5%E6%BA%90/%E8%BD%AC%E8%BD%BD/">转载</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/%E8%AF%AD%E8%A8%80/">语言</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/%E8%AF%AD%E8%A8%80/c-c%E8%AF%AD%E8%A8%80/">c++&c语言</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/17/language_c_cpp_skills_bit_2/" class="title">按位指定结构体中变量的大小</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-17T01:16:54.603Z" itemprop="datePublished">2021-03-17</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E8%AF%AD%E8%A8%80/">语言</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/%E8%AF%AD%E8%A8%80/c-c%E8%AF%AD%E8%A8%80/">c++&c语言</a>
              </p>
              <p class="item-title">
                <a href="/2021/03/17/language_c_cpp_function_1_c/" class="title">函数</a>
              </p>
              <p class="item-date">
                <time datetime="2021-03-17T00:55:39.668Z" itemprop="datePublished">2021-03-17</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<main class="main" role="main">
  <div class="content">
  <article id="post-language_c_cpp_keyword_convert" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      c++强制类型转换
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/03/15/language_c_cpp_keyword_convert/" class="article-date">
	  <time datetime="2021-03-15T14:17:14.269Z" itemprop="datePublished">2021-03-15</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/%E8%AF%AD%E8%A8%80/">语言</a>►<a class="article-category-link" href="/categories/%E8%AF%AD%E8%A8%80/c-c%E8%AF%AD%E8%A8%80/">c++&c语言</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link-link" href="/tags/c-c%E8%AF%AD%E8%A8%80/" rel="tag">c++&c语言</a>
  </span>


        

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/03/15/language_c_cpp_keyword_convert/#comments" class="article-comment-link">评论</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <p>类型转换操作符:static_cast, dynamic_cast, const_cast, reinterpret_cast.</p>
<p>呵呵，今天来好好看看着几个转换操作符的用法。以前老是看着眼熟，但是用着手生。今天决定搞定这些个东西。<br>在C语言中类型转换有几种方式：</p>
<ol>
<li><pre><code> (expression). 在表达式外边加括号，由编译器来决定怎么改变。
</code></pre>
</li>
<li><pre><code> new_type(expression）. 强制类型括号住表达式。
</code></pre>
</li>
<li><pre><code> (new_type)expression. 括号住强制类型。
</code></pre>
</li>
<li><pre><code> C语言允许的内置转换。
</code></pre>
</li>
</ol>
<p>这些转换非常高效，我非常喜欢使用。特别是在指针转换和数值转换时用到的非常多。只要编写程序的人知道自己要做什么转换，并知道应该怎样转换的话，我认为上边的转换方式非常之好。但是没有清楚的了解每个转换的细节的话，就有可能出现问题，比如指针指向不应该指向的区域：出现野指针或者指向位置错误（主要是对内存结构不了解），或者计算数值被截去等问题发生。<br>C++程序兼容C语言的转化，但是针对面向对象语言的特性，设计了以下几个类型转换操作符。他们的出现是为了C语言类型转换中语义模糊和固有的危险陷阱，因为<strong>C语言不去判断所要操作的类型转换是否合理</strong>。<br>static_cast:用于非多态类型的转换。<br>dynamic_cast:用于多态类型的转换。<br>const_cast:用来消除const, volatile, __unaligned属性的转换。<br>reinterpret_cast:用于空间的重新解释。<br>还有一个在VS2005中出现的类型转换关键字safe_cast.#2</p>
<p><strong>static_cast</strong>:<br>static_cast<type_id>(expression)<br>用于类层次结构中基类和子类之间指针或引用的转换。进行上行转换（把子类的指针或引用转换成基类表示）是安全的；进行下行转换（把基类指针或引用转换成子类表示）时，由于没有动态类型检查，所以是不安全的。<br>用于基本数据类型之间的转换，如把int转换成char，把int转换成enum。这种转换的安全性也要开发人员来保证。<br>把空指针转换成目标类型的空指针。<br>把任何类型的表达式转换成void类型。<br>注意：static_cast不能转换掉expression的const、volitale、或者__unaligned属性。<br>enum e { A = 1, B, C };<br>double d = 12.25;<br>unsigned int ui = 25;<br>char c = static_cast<char>(ui);<br>int i = static_cast<int>(d);<br>int j = static_cast<int>(B);<br>//父类子类转换<br>class F                  //father<br>{<br>public:<br>    int _father;<br>};<br>class S : public F       //son<br>{<br>public:<br>    _son;<br>};<br>F *pFather = new F();<br>S *pSon = new S();<br>F *pF;<br>S *pS;<br>pF = static_cast&lt;F *&gt;(pSon);    //将子类指针转换为父类指针，OK<br>pS = static_cast&lt;S *&gt;(pFather); //将父类指针转换为子类指针，错误<br>第二个错误的转换不是说编译器编译不过去，而是运行时会出现错误。<br>原因如下：假设pF指向了pSon的位置，它可以访问_father，它找不到_son，这样没有问题。但是pS指向了pFather的位置，它访问_father没有问题，但是访问_son时就会产生错误，因为pFather根本没有_son这个变量。<br>下面是将父类转换为子类指针时，static_cast和dymanic_cast两者不同的表现：<br>class F<br>{<br>public:<br>    virtual void speak(){};<br>    int i;<br>};</p>
<p>class S : public F<br>{<br>public:<br>    void speak()<br>    {<br>       cout &lt;&lt; “S = “ &lt;&lt; _s &lt;&lt; endl;<br>    }<br>    double _s;<br>};<br>F *pF = new F();<br>S *pS = static_cast&lt;S*&gt;(pF);<br>pS-&gt;speak();<br>S1 *pDS = dynamic_cast&lt;S*&gt;(pF);<br>pDS-&gt;speak();<br>静态的转换编译不显示警告，运行结果不输出(调用F的speak函数)。动态的转换编译显示可能出现不可预期的结果，运行时崩溃。（VS2005时，返回空指针，但是不会崩溃。我认为要是按照C++的特性还是崩溃比较好一点，让程序员容易理解这么做是错误的。）</p>
<p><strong>dynamic_cast</strong>:<br>dynamic_cast<type_id>(expression)<br>该运算符把expression转换成type-id类型的对象。Type-id必须是类的指针、类的引用或者void *；如果type-id是类指针类型，那么expression也必须是一个指针，如果type-id是一个引用，那么expression也必须是一个引用。</p>
<p>dynamic_cast主要用于类层次间的上行转换和下行转换，还可以用于类之间的交叉转换。</p>
<p>在类层次间进行上行转换时，dynamic_cast和static_cast的效果是一样的；在进行下行转换时，dynamic_cast具有类型检查的功能，比static_cast更安全。</p>
<p>dynamic_cast 判定转换是否成功<br>if (!dynamic_cast&lt;MapContext*&gt;(context)-&gt;GetInputType().empty()) {}</p>
<p> class B{<br>public:<br>    int m_iNum;<br>    virtual void foo();</p>
<p>};</p>
<p>class D:public B{<br> public:<br>    char *m_szName[100];<br>};</p>
<p>void func(B *pb){<br>     D *pd1 = static_cast&lt;D *&gt;(pb);<br>     D *pd2 = dynamic_cast&lt;D *&gt;(pb);<br>}</p>
<p>在上面的代码段中，如果pb指向一个D类型的对象，pd1和pd2是一样的，并且对这两个指针执行D类型的任何操作都是安全的；但是，如果pb指向的是一个B类型的对象，那么pd1将是一个指向该对象的指针，对它进行D类型的操作将是不安全的（如访问m_szName），而pd2将是一个空指针。另外要注意：B要有虚函数，否则会编译出错；static_cast则没有这个限制。这是由于运行时类型检查需要运行时类型信息，而这个信息存储在类的虚函数表（关于虚函数表的概念，详细可见&lt;Inside c++ object model&gt;）中，只有定义了虚函数的类才有虚函数表，没有定义虚函数的类是没有虚函数表的。</p>
<p>另外，dynamic_cast还支持交叉转换（cross cast）。如下代码所示。</p>
<p>class A{<br>public:<br>    int m_iNum;<br>    virtual void f(){}</p>
<p>};</p>
<p>class B:public A{<br>};</p>
<p>class D:public A{<br>};</p>
<p>void foo(){<br> B *pb = new B;<br> pb-&gt;m_iNum = 100;</p>
<p> D *pd1 = static_cast&lt;D *&gt;(pb); //copile error<br> D *pd2 = dynamic_cast&lt;D *&gt;(pb); //pd2 is NULL<br> delete pb;</p>
<p>}</p>
<p>在函数foo中，使用 static_cast 进行转换是不被允许的，将在编译时出错；而使用  dynamic_cast 的转换则是允许的，结果是空指针。</p>
<p>1．最常用的用法就是将子类指针转换为父类指针。（不举例）<br>2．当type_id为void*时，指针指向整个对象的空间。<br>Class A;<br>A *pA = new A();<br>void <em>p = dynamic_cast&lt;void*&gt;(pA);<br>但是type_id不为void</em>时，计算机就要在运行时检查是否能够转换。<br>3．跳级转换。<br>class A{};<br>class B : public A{};<br>class C : public B{};<br>    A *pA;<br>    B *pB;<br>    C *pC = new C();<br>    pB = dynamic_cast&lt;B*&gt;(pD);  //逐级转换OK<br>    pA = dynamic_cast&lt;A*&gt;(pB);  //逐级转换OK<br>    或者<br>    pA = dynamic_cast&lt;A*&gt;(pC);  //跳级转换OK<br>    delete pD;<br>以下情况跳级转换不可以：<br>class A{};<br>class B : public A{};<br>class C : public A{};<br>class D : public B, public C{};<br>    A *pA;<br>    D *pD = new D();<br>    pA = dynamic_cast&lt;A*&gt;(pB);  //出现错误，是不行的，原因大家都清楚。</p>
<p>class A{};<br>class B : public A{};<br>class C : public A{};<br>class D : public B{};<br>class E : public C, public D{};<br>    A *pA;<br>    B <em>pB;<br>    E <em>pE = new E();<br>    pB = dynamic_cast&lt;B*&gt;(pE);<br>    pA = dynamic_cast&lt;A*&gt;(pB);  //可以<br>    pA = dynamic_cast&lt;A*&gt;(pE);  //不可以，原因是很简单的。<br>    delete pE;<br>4．两个不相干的类之间转换。<br>class A {};<br>class B {};<br>    A</em> pa = new A;<br>    B</em> pb = dynamic_cast&lt;B*&gt;(pa);   // 不可以，没有相互转换的基础<br>但是reinterpret_cast可以转换，可以参考reinterpret_cast</p>
<p><strong>const_cast:</strong><br>const_cast<type_id>(expression)<br>这个关键字消除了几个关键字的作用const, volatile,和__unaligned的作用。const经常使用。MSDN有const的例子照抄过来。<br>class CCTest {<br>public:<br>   void setNumber( int );<br>   void printNumber() const;<br>private:<br>   int number;<br>};<br>void CCTest::setNumber( int num ) { number = num; }<br>void CCTest::printNumber() const {<br>   cout &lt;&lt; “/nBefore: “ &lt;&lt; number;<br>   const_cast&lt; CCTest * &gt;( this )-&gt;number–;//这里消除了const的作用<br>   cout &lt;&lt; “/nAfter: “ &lt;&lt; number;<br>}<br>int main() {<br>   CCTest X;<br>   X.setNumber( 8 );<br>   X.printNumber();<br>}</p>
<p><strong>reinterpret_cast:</strong><br>reinterpret_cast<br>这个关键字比较“强悍”，随意转换类型。但是转换错误，就是你的不对了。呵呵，我的原则两个字：“慎用”。<br>这个关键字可以在任何类型的指针之间转换。<br>不可以替代const_cast。<br>不提供安全转换。<br>MSDN的例子显示出来它的强悍，也显示出了他的脆弱。只要你一个不小心就会乱用。<br>#include <iostream></p>
<p>// Returns a hash code based on an address<br>unsigned short Hash( void *p ) {<br>   unsigned int val = reinterpret_cast<unsigned int>( p );<br>   return ( unsigned short )( val ^ (val &gt;&gt; 16));<br>}</p>
<p>using namespace std;<br>int main() {<br>   int a[20];<br>   for ( int i = 0; i &lt; 20; i++ )<br>      cout &lt;&lt; Hash( a + i ) &lt;&lt; endl;<br>}</p>
<p><strong>参考文档</strong><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/callmeback/article/details/4040583">http://blog.csdn.net/callmeback/article/details/4040583</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/bboyfeiyu/article/details/9057447">https://blog.csdn.net/bboyfeiyu/article/details/9057447</a><br><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/2473628/c-cant-static-cast-from-double-to-int">https://stackoverflow.com/questions/2473628/c-cant-static-cast-from-double-to-int</a></p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://example.com/2021/03/15/language_c_cpp_keyword_convert/" title="c++强制类型转换" target="_blank" rel="external">http://example.com/2021/03/15/language_c_cpp_keyword_convert/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/cofess" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/cofess" target="_blank"><span class="text-dark">昵称</span><small class="ml-1x">Web Developer &amp; Designer</small></a></h3>
        <div>个人简介。</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/03/16/language_c_cpp_common_range/" title="c，c++数值取值范围"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/03/15/language_c_cpp_keyword_volatile_c/" title="volatile 关键字详解"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/cofess" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://weibo.com/cofess" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="https://twitter.com/iwebued" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
        <li><a href="https://www.behance.net/cofess" target="_blank" title="Behance" data-toggle=tooltip data-placement=top><i class="icon icon-behance"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   




   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: '',
    appKey: '',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: false
  });
  </script>

     







</body>
</html>